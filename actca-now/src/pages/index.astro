---
// --- IMPORTS ---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// --- DATA FETCHING ---
const allCalls = await getCollection('calls');
---

<BaseLayout>
  <main class="relative min-h-screen">
    <!-- Header - Top Right -->
    <header class="absolute top-8 right-8">
      <h1 class="text-2xl font-bold text-black">Make Your Voice Heard!</h1>
    </header>
    
    <!-- No-JS topic navigation (Safari-safe): rows are plain links to static pages -->
    <div class="topic-table-container fixed left-8 top-8 bottom-8 w-80 max-h-[calc(100vh-4rem)] overflow-y-auto">
      <table class="w-full" style="border-collapse: separate; border-spacing: 0 10px;">
        <tbody>
          {allCalls.map((call) => {
            const topicValue = call.data.topic;
            const topicLabels = {
              rail: 'High Speed Rail - NOW',
              housing: 'YIMBY - Housing',
              water: 'Water',
              health: 'Healthcare for Californians',
              rights: 'Rights - Fight I.C.E.',
              econ: 'CA $ for CA',
            } as const;
            const topicLabel = topicLabels[topicValue] ?? topicValue;

            return (
              <tr class="topic-row">
                <td class="p-0" style="border-width: 2px;">
                  <a
                    class="topic-row-button w-full font-bold text-lg border-2 border-black bg-white text-black p-[3px] text-center transition-colors block"
                    href={`/call/${call.id}/`}
                  >
                    {topicLabel}
                  </a>
                </td>
              </tr>
            );
          })}
        </tbody>
      </table>
    </div>
  </main>
</BaseLayout>

