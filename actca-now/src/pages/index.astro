---
// --- IMPORTS ---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// --- DATA FETCHING ---
const allCalls = await getCollection('calls');
---

<BaseLayout>
  <main class="relative min-h-screen bg-slate-900">
    <!-- No-JS topic navigation (Safari-safe): rows are plain links to static pages -->
    <div class="topic-table-container fixed left-8 top-28 sm:top-24 bottom-8 w-80 max-h-[calc(100vh-8rem)] overflow-y-auto">
      <table class="w-full" style="border-collapse: separate; border-spacing: 0 10px;">
        <tbody>
          {allCalls.map((call) => {
            const topicValue = call.data.topic;
            const topicLabels = {
              rail: 'High Speed Rail - NOW',
              housing: 'YIMBY - Housing',
              water: 'Water Sovereignty',
              health: 'Universal Healthcare',
              rights: 'Rights - Fight I.C.E.',
              econ: 'CA $ for CA',
              climate: 'Climate Action',
              energy: 'Energy Independence',
              education: 'Education Autonomy',
            } as const;
            const topicLabel = topicLabels[topicValue] ?? topicValue;

            return (
              <tr class="topic-row">
                <td class="p-0">
                  <a
                    class="topic-row-button w-full font-bold text-lg border-2 border-yellow-400 bg-slate-800 text-yellow-400 p-3 text-center transition-colors block rounded-lg hover:bg-slate-700"
                    href={`/call/${call.id}/`}
                  >
                    {topicLabel}
                  </a>
                </td>
              </tr>
            );
          })}
        </tbody>
      </table>
    </div>
  </main>
</BaseLayout>

